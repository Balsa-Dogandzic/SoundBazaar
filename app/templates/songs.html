<!DOCTYPE html>
<html lang="en">

<head>

    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <title>Besplatno</title>

    <link rel="stylesheet" href="/static/css/style.css">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.7.2/font/bootstrap-icons.css" rel="stylesheet">

    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>

</head>

<body>

    {% include 'common/navbar.html' %}

    <h1 class="mb-3 text-center">Slusaj besplatnu muziku</h1>

    {% for song in songs %}
    <div class="music-player">
        <div class="album-art">
            <img src="/static/images/logo.png" alt="Error">
        </div>
        <div class="song-info">
            <h2>{{song.title}}</h2>
            <p>{{song.name}}</p>
        </div>
        <div class="controls">
            <audio controls>
                <source src="/media/{{song.song}}" type="audio/mpeg">
                Your browser does not support the audio element.
            </audio>
            {% if session.get('user_type') == 1 %}
            <button class="player-link" data-bs-toggle="modal" data-bs-target="#myModal" data-id="{{ song.id }}"><i
                    class="bi bi-music-note-list"></i></button>
            {% endif %}
            {% if session.get('user_type') == 2 %}
            <a href="/songs/update/{{song.id}}/" class="player-link"><i class="bi bi-pencil-fill"></i></a>
            <a href="/songs/delete/{{song.id}}/" class="player-link"><i class="bi bi-trash-fill"></i></a>
            {% endif %}
        </div>
    </div>
    {% endfor %}

    <div class="modal fade" id="myModal" tabindex="-1" aria-labelledby="myModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="myModalLabel">Izaberi plejlistu</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <form id="playlist-modal-form" action="/playlists/song/add/" method="post">
                        <div class="mb-3">
                            <label for="selectOption" class="form-label">Vase plejliste</label>
                            <select class="form-select" id="selectOption" name="playlist">
                                <option selected>Izabri..</option>
                                {% for playlist in playlists %}
                                <option value="{{playlist.id}}">{{playlist.title}}</option>
                                {% endfor %}
                            </select>
                        </div>
                        <button type="submit" class="btn btn-primary">Sacuvaj</button>
                    </form>
                </div>
            </div>
        </div>
    </div>
    <!--
    <div class="music-player">
        <div class="album-art">
            <img src="/static/images/logo.png" alt="Error">
        </div>
        <div class="song-info">
            <h2>Reaggeton MNE</h2>
            <p>Josif Vukicevic</p>
        </div>
        <div class="controls">
            <audio controls controlsList="nodownload">
                <source src="/media/reggaetonMNE_AP6s7fz.mp3" type="audio/mpeg">
                Your browser does not support the audio element.
            </audio>

        </div>
    </div>

    <div class="music-player">
        <div class="album-art">
            <img src="/static/images/logo.png" alt="Error">
        </div>
        <div class="song-info">
            <h2>Jesen u meni</h2>
            <p>Pedja Vukicevic</p>
        </div>
        <div class="controls">
            <audio controls>
                <source src="/media/knjazev_grad_LqJ1Slq_MKu1vMC.mp3" type="audio/mpeg">
                Your browser does not support the audio element.
            </audio>
        </div>
    </div>
-->
    {% include 'common/footer.html' %}

    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz"
        crossorigin="anonymous"></script>
    <script src="https://kit.fontawesome.com/3e58fdca93.js" crossorigin="anonymous"></script>
    <script src="/static/js/main.js"></script>
    <script src="/static/js/script-for-freeSongs_download.js"></script>
    <script src="/static/js/script-for-freeSongs_play.js"></script>

    <script src="/static/js/script-for-sort_table.js"></script>
    <script src="/static/js/script-for-search.js"></script>

    <script>
        var myModal = document.getElementById('myModal');
        myModal.addEventListener('show.bs.modal', function (event) {
            var button = event.relatedTarget;
            var id = button.getAttribute('data-id');
            var form = document.getElementById('playlist-modal-form');
            form.action = `/playlists/song/add/${id}/`;
        });
    </script>

</body>

</html>